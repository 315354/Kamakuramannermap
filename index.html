<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Kamakura Map</title>

  <!-- Leaflet 読み込み -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <style>
    body { margin:0; display:flex; font-family: sans-serif; }
    #map { height: 100vh; width: 70%; }
    #sidebar { width: 30%; padding: 10px; box-sizing: border-box; overflow-y: auto; background: #f5f5f5; }
    .item { margin-bottom: 15px; padding: 8px; border-radius: 4px; cursor: pointer; box-shadow: 0 1px 3px rgba(0,0,0,0.1); color:#fff; font-weight: bold; }
    .item:hover { opacity: 0.85; }
    .high { background-color: #e74c3c; }    /* 赤：重要 */
    .medium { background-color: #f39c12; }  /* オレンジ：注意 */
    .low { background-color: #27ae60; }     /* 緑：補助 */
    .item img { width:100%; border-radius:4px; margin-bottom:5px; }
    .item p { margin:0; font-weight:normal; color:#fff; }
  </style>
</head>
<body>

<div id="map"></div>
<div id="sidebar">
  <h2>マナー啓発ポイント</h2>
  <div id="list"></div>
</div>

<script>

  // マップ作成
  var map = L.map('map').setView([35.3198, 139.5520], 17);

  // タイル
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19
  }).addTo(map);

  // ★★ マナー啓発ポイントデータ（画像・説明付き） ★★
  var points = [
    {lat:35.319376, lng:139.551265, title:"小町通り 大鳥居", detail:"入口付近ではゴミは必ず持ち帰りましょう。", level:"high", img:"https://cdn.pixabay.com/photo/2017/02/01/22/02/trash-2034250_960_720.jpg"},
    {lat:35.320342, lng:139.551733, title:"小町通り商店街", detail:"歩きながらの飲食は控えましょう。", level:"medium", img:"https://cdn.pixabay.com/photo/2017/08/10/03/25/eating-2611922_960_720.jpg"},
    {lat:35.322364, lng:139.552682, title:"小町通り", detail:"通りではペットはリード必須です。", level:"low", img:"https://cdn.pixabay.com/photo/2016/11/29/10/07/dog-1868085_960_720.jpg"},
    {lat:35.324273, lng:139.553724, title:"小町通り終点", detail:"観光客同士や地元の方に迷惑をかけないように心がけましょう。", level:"medium", img:"https://cdn.pixabay.com/photo/2015/09/05/21/51/tourist-926051_960_720.jpg"}
  ];

  var listDiv = document.getElementById("list");

  // アイコンを注意度ごとに設定
  function getIcon(level){
    var color;
    if(level === "high") color = "red";
    else if(level === "medium") color = "orange";
    else color = "green";

    return L.icon({
      iconUrl: "https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-" + color + ".png",
      shadowUrl: "https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png",
      iconSize: [25, 41],
      iconAnchor: [12, 41],
      popupAnchor: [1, -34],
      shadowSize: [41, 41]
    });
  }

  points.forEach(function(point){
    // マーカー作成
    var marker = L.marker([point.lat, point.lng], {icon: getIcon(point.level)}).addTo(map)
      .bindPopup("<b>" + point.title + "</b><br>" + point.detail);

    // サイドバーにリスト作成（画像＋タイトル＋説明）
    var item = document.createElement("div");
    item.className = "item " + point.level;
    item.innerHTML = `
      <img src="${point.img}" alt="${point.title}">
      <strong>${point.title}</strong>
      <p>${point.detail}</p>
    `;
    item.onclick = function() {
      map.setView([point.lat, point.lng], 18);
      marker.openPopup();
    };
    listDiv.appendChild(item);
  });

  // 入口〜ゴール ルート（4点）
  L.polyline([
    [35.319414, 139.551258],
    [35.320386, 139.551759],
    [35.322326, 139.552674],
    [35.324286, 139.553731]
  ], {
    color: '#ff0000',
    weight: 8,
    opacity: 0.5,
    dashArray: '10, 10'
  }).addTo(map);

  // ズーム固定
  map.scrollWheelZoom.disable();
  map.touchZoom.disable();
  map.doubleClickZoom.disable();
  map.boxZoom.disable();
  map.keyboard.disable();

  map.setMinZoom(17);
  map.setMaxZoom(17);

</script>

</body>
</html>

