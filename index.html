<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Kamakura Map - サイドバー改良版</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<style>
  html, body { margin:0; padding:0; height:100%; font-family:sans-serif; }
  body { display:flex; transition: all 0.3s; }
  #map { flex:1; transition: margin-left 0.3s; height:100vh; }

  #sidebar {
    width:350px;
    max-width:80%;
    background:#f5f5f5;
    overflow-y:auto;
    position:fixed;
    left:-350px;
    top:0;
    bottom:0;
    transition:left 0.3s;
    padding:15px;
    box-sizing:border-box;
    z-index:1000;
  }
  #sidebar.open { left:0; }

  #toggleBtn {
    position:fixed;
    top:10px;
    left:0;
    z-index:1100;
    padding:6px 12px;
    background:#3498db;
    color:#fff;
    border:none;
    cursor:pointer;
    border-radius:3px;
    font-size:14px;
    transition:left 0.3s;
  }
  #toggleBtn.open { left:350px; }

  h2 { margin-top:0; }

  .category {
    margin-top:20px;
  }
  .category h3 {
    margin-bottom:10px;
    border-bottom:1px solid #ccc;
    padding-bottom:4px;
    font-size:16px;
    color:#333;
  }

  .item { 
    margin-bottom: 15px; 
    padding: 10px; 
    border-radius: 5px; 
    cursor: pointer; 
    box-shadow: 0 1px 3px rgba(0,0,0,0.1); 
    background-color:#3498db;
    color:#fff; 
    transition: transform 0.1s, box-shadow 0.2s;
  }
  .item:hover { 
    transform: scale(1.02);
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
  }
  .item img { width:100%; border-radius:4px; margin-bottom:8px; }
  .item .title { font-size:16px; font-weight:bold; margin-bottom:4px; display:flex; align-items:center; }
  .item .title .level { margin-left:6px; font-size:14px; padding:2px 6px; border-radius:3px; color:#fff; }
  .high .level { background:#e74c3c; }
  .medium .level { background:#f39c12; }
  .low .level { background:#27ae60; }
  .item p { margin:0; font-size:14px; line-height:1.3; }

  @media(max-width:768px){
    body { flex-direction: column; }
    #sidebar { width:100%; left:-100%; }
    #sidebar.open { left:0; }
    #map { height:50vh; margin-left:0; }
    #toggleBtn.open { left:0; }
  }
</style>
</head>
<body>

<button id="toggleBtn" onclick="toggleSidebar()">☰ マナー啓発</button>
<div id="sidebar">
  <h2>マナー啓発ポイント</h2>
  <div id="list"></div>
</div>
<div id="map"></div>

<script>
var sidebarOpen = false;
var sidebar = document.getElementById('sidebar');
var toggleBtn = document.getElementById('toggleBtn');

function toggleSidebar() {
  sidebarOpen = !sidebarOpen;
  sidebar.classList.toggle('open', sidebarOpen);
  toggleBtn.classList.toggle('open', sidebarOpen);
}

// マップ作成
var map = L.map('map').setView([35.3198, 139.5520], 17);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom:19 }).addTo(map);

// マナー啓発データ（カテゴリ別）
var points = [
  {lat:35.319376, lng:139.551265, title:"ゴミは持ち帰ろう", detail:"入口付近ではゴミは必ず持ち帰りましょう。", level:"high", img:"https://cdn.pixabay.com/photo/2017/02/01/22/02/trash-2034250_960_720.jpg", category:"ゴミ・環境"},
  {lat:35.320342
